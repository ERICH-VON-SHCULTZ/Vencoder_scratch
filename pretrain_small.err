wandb: WARNING Disabling SSL verification.  Connections to this server are not verified and may be insecure!
wandb: Currently logged in as: qz2086 (pichenygroup) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: setting up run jmdop37j
wandb: Tracking run with wandb version 0.23.0
wandb: Run data is saved locally in /scratch/qz2086/fall2025_finalproject/code/wandb/run-20251130_090528-jmdop37j
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dino_vit_patch8_bs384_lr5e-05_ep20
wandb: ‚≠êÔ∏è View project at https://wandb.ai/pichenygroup/vit-small-finally-working
wandb: üöÄ View run at https://wandb.ai/pichenygroup/vit-small-finally-working/runs/jmdop37j
wandb: WARNING The get_url method is deprecated and will be removed in a future release. Please use `run.url` instead.
2025-11-30 09:05:30,993 - INFO - Arguments: Namespace(data_dir='/scratch/qz2086/fall2025_finalproject/data', patch_size=8, out_dim=2048, norm_last_layer=True, use_bn_in_head=False, drop_path_rate=0.1, batch_size=384, epochs=20, warmup_epochs=1, lr=5e-05, min_lr=1e-06, weight_decay=0.04, weight_decay_end=0.1, clip_grad=3.0, momentum_teacher=0.996, teacher_temp=0.1, warmup_teacher_temp=0.1, warmup_teacher_temp_epochs=2, local_crops_number=2, knn_k=20, knn_search=True, wandb_project='vit-small-finally-working', no_wandb=False, log_freq=50, output_dir='./checkpoints', num_workers=8, seed=42, world_size=1, resume='', evaluate=True, val_freq=2, save_freq=3)
2025-11-30 09:05:31,010 - INFO - Creating dataloaders from part1-5 directories...
/ext3/miniforge3/envs/dl_310/lib/python3.10/site-packages/torch/utils/data/dataloader.py:627: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
2025-11-30 09:05:40,655 - INFO - Train loader: 1171 batches per epoch
2025-11-30 09:05:40,655 - INFO - Val loader: 130 batches per epoch
2025-11-30 09:05:40,655 - INFO - Creating ViT-Small models...
/ext3/miniforge3/envs/dl_310/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:144: FutureWarning: `torch.nn.utils.weight_norm` is deprecated in favor of `torch.nn.utils.parametrizations.weight_norm`.
  WeightNorm.apply(module, name, dim)
2025-11-30 09:05:41,620 - INFO - Student and teacher created
2025-11-30 09:05:41,625 - INFO - Training schedule:
2025-11-30 09:05:41,625 - INFO -   Iterations per epoch: 1171
2025-11-30 09:05:41,625 - INFO -   Total iterations: 23420
2025-11-30 09:05:41,625 - INFO -   Initial LR: 0.000000
2025-11-30 09:05:41,625 - INFO -   Peak LR (after warmup): 0.000050
2025-11-30 09:05:41,626 - INFO -   Final LR: 0.000001
/scratch/qz2086/fall2025_finalproject/code/train.py:456: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
2025-11-30 09:05:41,626 - INFO - Starting training...
2025-11-30 09:05:41,626 - INFO - 
============================================================
2025-11-30 09:05:41,626 - INFO - Epoch 1/20
2025-11-30 09:05:41,627 - INFO - ============================================================
Epoch 1/20:   0%|          | 0/1171 [00:00<?, ?it/s]/scratch/qz2086/fall2025_finalproject/code/train.py:227: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1/20:   0%|          | 0/1171 [00:15<?, ?it/s, loss=7.6643, lr=0.000000]Epoch 1/20:   0%|          | 1/1171 [00:15<5:09:43, 15.88s/it, loss=7.6643, lr=0.000000]Epoch 1/20:   0%|          | 1/1171 [00:17<5:09:43, 15.88s/it, loss=7.6657, lr=0.000000]Epoch 1/20:   0%|          | 2/1171 [00:17<2:22:15,  7.30s/it, loss=7.6657, lr=0.000000]Epoch 1/20:   0%|          | 2/1171 [00:18<2:22:15,  7.30s/it, loss=7.6744, lr=0.000000]Epoch 1/20:   0%|          | 3/1171 [00:18<1:28:42,  4.56s/it, loss=7.6744, lr=0.000000]Epoch 1/20:   0%|          | 3/1171 [00:19<1:28:42,  4.56s/it, loss=7.6794, lr=0.000000]Epoch 1/20:   0%|          | 4/1171 [00:19<1:03:32,  3.27s/it, loss=7.6794, lr=0.000000]Epoch 1/20:   0%|          | 4/1171 [00:21<1:03:32,  3.27s/it, loss=7.6850, lr=0.000000]Epoch 1/20:   0%|          | 5/1171 [00:21<49:40,  2.56s/it, loss=7.6850, lr=0.000000]  Epoch 1/20:   0%|          | 5/1171 [00:22<49:40,  2.56s/it, loss=7.6896, lr=0.000000]Epoch 1/20:   1%|          | 6/1171 [00:22<41:17,  2.13s/it, loss=7.6896, lr=0.000000]Epoch 1/20:   1%|          | 6/1171 [00:23<41:17,  2.13s/it, loss=7.6928, lr=0.000000]Epoch 1/20:   1%|          | 7/1171 [00:23<35:57,  1.85s/it, loss=7.6928, lr=0.000000]Epoch 1/20:   1%|          | 7/1171 [00:24<35:57,  1.85s/it, loss=7.6985, lr=0.000000]Epoch 1/20:   1%|          | 8/1171 [00:24<32:28,  1.68s/it, loss=7.6985, lr=0.000000]Epoch 1/20:   1%|          | 8/1171 [00:26<32:28,  1.68s/it, loss=7.7014, lr=0.000000]Epoch 1/20:   1%|          | 9/1171 [00:26<30:08,  1.56s/it, loss=7.7014, lr=0.000000]Epoch 1/20:   1%|          | 9/1171 [00:27<30:08,  1.56s/it, loss=7.7053, lr=0.000000]Epoch 1/20:   1%|          | 10/1171 [00:27<28:33,  1.48s/it, loss=7.7053, lr=0.000000]Epoch 1/20:   1%|          | 10/1171 [00:28<28:33,  1.48s/it, loss=7.7089, lr=0.000000]Epoch 1/20:   1%|          | 11/1171 [00:28<27:28,  1.42s/it, loss=7.7089, lr=0.000000]Epoch 1/20:   1%|          | 11/1171 [00:30<27:28,  1.42s/it, loss=7.7117, lr=0.000000]Epoch 1/20:   1%|          | 12/1171 [00:30<26:43,  1.38s/it, loss=7.7117, lr=0.000000]Epoch 1/20:   1%|          | 12/1171 [00:31<26:43,  1.38s/it, loss=7.7146, lr=0.000001]Epoch 1/20:   1%|          | 13/1171 [00:31<26:11,  1.36s/it, loss=7.7146, lr=0.000001]Epoch 1/20:   1%|          | 13/1171 [00:32<26:11,  1.36s/it, loss=7.7170, lr=0.000001]Epoch 1/20:   1%|          | 14/1171 [00:32<25:51,  1.34s/it, loss=7.7170, lr=0.000001]Epoch 1/20:   1%|          | 14/1171 [00:34<25:51,  1.34s/it, loss=7.7197, lr=0.000001]Epoch 1/20:   1%|‚ñè         | 15/1171 [00:34<25:39,  1.33s/it, loss=7.7197, lr=0.000001]Epoch 1/20:   1%|‚ñè         | 15/1171 [00:35<25:39,  1.33s/it, loss=7.7221, lr=0.000001]Epoch 1/20:   1%|‚ñè         | 16/1171 [00:35<25:27,  1.32s/it, loss=7.7221, lr=0.000001]Epoch 1/20:   1%|‚ñè         | 16/1171 [00:36<25:27,  1.32s/it, loss=7.7244, lr=0.000001]Epoch 1/20:   1%|‚ñè         | 17/1171 [00:36<25:17,  1.31s/it, loss=7.7244, lr=0.000001]Epoch 1/20:   1%|‚ñè         | 17/1171 [00:37<25:17,  1.31s/it, loss=7.7262, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 18/1171 [00:37<25:09,  1.31s/it, loss=7.7262, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 18/1171 [00:39<25:09,  1.31s/it, loss=7.7278, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 19/1171 [00:39<25:05,  1.31s/it, loss=7.7278, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 19/1171 [00:40<25:05,  1.31s/it, loss=7.7298, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 20/1171 [00:40<25:01,  1.30s/it, loss=7.7298, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 20/1171 [00:41<25:01,  1.30s/it, loss=7.7317, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 21/1171 [00:41<24:57,  1.30s/it, loss=7.7317, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 21/1171 [00:43<24:57,  1.30s/it, loss=7.7330, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 22/1171 [00:43<24:55,  1.30s/it, loss=7.7330, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 22/1171 [00:44<24:55,  1.30s/it, loss=7.7342, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 23/1171 [00:44<24:53,  1.30s/it, loss=7.7342, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 23/1171 [00:45<24:53,  1.30s/it, loss=7.7354, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 24/1171 [00:45<25:03,  1.31s/it, loss=7.7354, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 24/1171 [00:47<25:03,  1.31s/it, loss=7.7365, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 25/1171 [00:47<25:05,  1.31s/it, loss=7.7365, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 25/1171 [00:48<25:05,  1.31s/it, loss=7.7374, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 26/1171 [00:48<24:59,  1.31s/it, loss=7.7374, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 26/1171 [00:49<24:59,  1.31s/it, loss=7.7382, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 27/1171 [00:49<24:54,  1.31s/it, loss=7.7382, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 27/1171 [00:50<24:54,  1.31s/it, loss=7.7391, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 28/1171 [00:50<24:50,  1.30s/it, loss=7.7391, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 28/1171 [00:52<24:50,  1.30s/it, loss=7.7401, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 29/1171 [00:52<24:46,  1.30s/it, loss=7.7401, lr=0.000001]Epoch 1/20:   2%|‚ñè         | 29/1171 [00:53<24:46,  1.30s/it, loss=7.7408, lr=0.000001]Epoch 1/20:   3%|‚ñé         | 30/1171 [00:53<24:44,  1.30s/it, loss=7.7408, lr=0.000001]Epoch 1/20:   3%|‚ñé         | 30/1171 [00:54<24:44,  1.30s/it, loss=7.7416, lr=0.000001]Epoch 1/20:   3%|‚ñé         | 31/1171 [00:54<24:42,  1.30s/it, loss=7.7416, lr=0.000001]Epoch 1/20:   3%|‚ñé         | 31/1171 [00:56<24:42,  1.30s/it, loss=7.7424, lr=0.000001]Epoch 1/20:   3%|‚ñé         | 32/1171 [00:56<24:40,  1.30s/it, loss=7.7424, lr=0.000001]Epoch 1/20:   3%|‚ñé         | 32/1171 [00:58<24:40,  1.30s/it, loss=7.7427, lr=0.000001]Epoch 1/20:   3%|‚ñé         | 33/1171 [00:58<30:26,  1.60s/it, loss=7.7427, lr=0.000001]Epoch 1/20:   3%|‚ñé         | 33/1171 [00:59<30:26,  1.60s/it, loss=7.7430, lr=0.000001]Epoch 1/20:   3%|‚ñé         | 34/1171 [00:59<28:40,  1.51s/it, loss=7.7430, lr=0.000001]Epoch 1/20:   3%|‚ñé         | 34/1171 [01:01<28:40,  1.51s/it, loss=7.7434, lr=0.000001]Epoch 1/20:   3%|‚ñé         | 35/1171 [01:01<27:26,  1.45s/it, loss=7.7434, lr=0.000001]Epoch 1/20:   3%|‚ñé         | 35/1171 [01:02<27:26,  1.45s/it, loss=7.7440, lr=0.000001]Epoch 1/20:   3%|‚ñé         | 36/1171 [01:02<26:34,  1.40s/it, loss=7.7440, lr=0.000001]Epoch 1/20:   3%|‚ñé         | 36/1171 [01:03<26:34,  1.40s/it, loss=7.7443, lr=0.000002]Epoch 1/20:   3%|‚ñé         | 37/1171 [01:03<25:57,  1.37s/it, loss=7.7443, lr=0.000002]Epoch 1/20:   3%|‚ñé         | 37/1171 [01:04<25:57,  1.37s/it, loss=7.7444, lr=0.000002]Epoch 1/20:   3%|‚ñé         | 38/1171 [01:04<25:31,  1.35s/it, loss=7.7444, lr=0.000002]Epoch 1/20:   3%|‚ñé         | 38/1171 [01:06<25:31,  1.35s/it, loss=7.7445, lr=0.000002]Epoch 1/20:   3%|‚ñé         | 39/1171 [01:06<25:12,  1.34s/it, loss=7.7445, lr=0.000002]Epoch 1/20:   3%|‚ñé         | 39/1171 [01:07<25:12,  1.34s/it, loss=7.7448, lr=0.000002]Epoch 1/20:   3%|‚ñé         | 40/1171 [01:07<24:59,  1.33s/it, loss=7.7448, lr=0.000002]Epoch 1/20:   3%|‚ñé         | 40/1171 [01:10<24:59,  1.33s/it, loss=7.7449, lr=0.000002]Epoch 1/20:   4%|‚ñé         | 41/1171 [01:10<33:42,  1.79s/it, loss=7.7449, lr=0.000002]